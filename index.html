<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genome Connections Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .selected { 
            background-color: #3b82f6;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">
    <div class="container mx-auto max-w-md p-6 bg-white rounded-xl shadow-lg">
        <h1 class="text-2xl font-bold text-center mb-4">Genome Connections</h1>
        
        <div id="game-board" class="grid grid-cols-4 gap-4 mb-6">
            <!-- Words will be dynamically inserted here -->
        </div>

        <div id="attempts" class="text-center mb-4 text-gray-600">
            Attempts Remaining: <span id="attempts-count">4</span>
        </div>

        <div id="solved-categories" class="mb-4">
            <!-- Solved categories will be displayed here -->
        </div>

        <div class="flex space-x-2">
            <button id="submit-btn" class="flex-1 bg-blue-500 text-white py-2 rounded opacity-50 cursor-not-allowed" disabled>
                Submit Group
            </button>
            <button id="deselect-btn" class="flex-1 bg-gray-200 text-gray-700 py-2 rounded">
                Deselect All
            </button>
        </div>

        <div id="game-message" class="text-center mt-4 font-bold"></div>
    </div>

    <script>
        const genomeCategories = [
            {
                name: "Publisher Genome",
                words: ["Publishing Frequency", "Mobile responsiveness", "Brand rating", "Editorial policies"],
                color: "bg-green-200"
            },
            {
                name: "User Genome",
                words: ["Attention span", "Location", "Purchasing power", "Interests"],
                color: "bg-yellow-200"
            },
            {
                name: "Content Genome",
                words: ["Quality", "Word count", "Format", "Headline"],
                color: "bg-blue-200"
            },
            {
                name: "Economic Genome",
                words: ["PPP", "Volatility", "Bid & Ask spread", "Inflation"],
                color: "bg-purple-200"
            }
        ];

        class GenomeConnectionsGame {
            constructor() {
                this.gameBoard = document.getElementById('game-board');
                this.submitBtn = document.getElementById('submit-btn');
                this.deselectBtn = document.getElementById('deselect-btn');
                this.attemptsCount = document.getElementById('attempts-count');
                this.solvedCategories = document.getElementById('solved-categories');
                this.gameMessage = document.getElementById('game-message');

                this.selectedWords = [];
                this.remainingAttempts = 4;
                this.solvedCategoriesCount = 0;

                this.initializeGame();
            }

            initializeGame() {
                // Shuffle and display words
                const allWords = genomeCategories.flatMap(cat => cat.words);
                const shuffledWords = this.shuffleArray(allWords);

                shuffledWords.forEach(word => {
                    const wordElement = document.createElement('div');
                    wordElement.textContent = word;
                    wordElement.classList.add(
                        'p-4', 'text-center', 'bg-gray-200', 'rounded', 'cursor-pointer', 'hover:bg-blue-100'
                    );
                    wordElement.addEventListener('click', () => this.selectWord(word, wordElement));
                    this.gameBoard.appendChild(wordElement);
                });

                this.submitBtn.addEventListener('click', () => this.checkCategory());
                this.deselectBtn.addEventListener('click', () => this.deselectAll());
            }

            selectWord(word, element) {
                if (this.selectedWords.includes(word)) {
                    this.selectedWords = this.selectedWords.filter(w => w !== word);
                    element.classList.remove('selected');
                } else if (this.selectedWords.length < 4) {
                    this.selectedWords.push(word);
                    element.classList.add('selected');
                }

                // Enable/disable submit button
                this.submitBtn.disabled = this.selectedWords.length !== 4;
                this.submitBtn.classList.toggle('opacity-50', this.selectedWords.length !== 4);
                this.submitBtn.classList.toggle('cursor-not-allowed', this.selectedWords.length !== 4);
            }

            checkCategory() {
                if (this.selectedWords.length !== 4) return;

                const matchedCategory = genomeCategories.find(category => 
                    category.words.every(word => this.selectedWords.includes(word))
                );

                if (matchedCategory) {
                    this.revealCategory(matchedCategory);
                    this.deselectAll();
                    this.solvedCategoriesCount++;

                    if (this.solvedCategoriesCount === 4) {
                        this.gameMessage.textContent = "Congratulations! You solved all categories!";
                        this.gameMessage.classList.add('text-green-600');
                    }
                } else {
                    this.remainingAttempts--;
                    this.attemptsCount.textContent = this.remainingAttempts;
                    this.deselectAll();

                    if (this.remainingAttempts === 0) {
                        this.gameMessage.textContent = "Game Over! No more attempts left.";
                        this.gameMessage.classList.add('text-red-600');
                    }
                }
            }

            revealCategory(category) {
                const categoryElement = document.createElement('div');
                categoryElement.classList.add(
                    category.color, 'p-2', 'rounded', 'mb-2', 'text-center'
                );
                categoryElement.textContent = `${category.name}: ${category.words.join(', ')}`;
                this.solvedCategories.appendChild(categoryElement);

                // Remove revealed words from game board
                category.words.forEach(word => {
                    const wordElements = this.gameBoard.querySelectorAll('div');
                    wordElements.forEach(el => {
                        if (el.textContent === word) {
                            el.remove();
                        }
                    });
                });
            }

            deselectAll() {
                this.selectedWords = [];
                const wordElements = this.gameBoard.querySelectorAll('div');
                wordElements.forEach(el => el.classList.remove('selected'));

                this.submitBtn.disabled = true;
                this.submitBtn.classList.add('opacity-50', 'cursor-not-allowed');
            }

            shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }
        }

        // Initialize the game when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            new GenomeConnectionsGame();
        });
    </script>
</body>
</html>